# Baseball Video Annotator

野球の試合映像を解析し、一球ごとのセグメント分割と詳細なタグ付けを効率化するためのWebアプリケーションです。

## 主な機能

### 1. 動画解析と自動カット検出
- 動画ファイルをドラッグ＆ドロップするだけで読み込み可能。
- 撮影の停止・再開による「フレームの飛び」をバックエンドで自動検出し、ブックマーク（栞）を自動挿入します。
- **検出感度調整:** サイドバーまたは設定画面から感度（閾値）を調整し、再解析が可能です。

### 2. インタラクティブなタイムライン
- **2段階ビュー:** 動画全体を表示する `Overview` と、現在位置周辺を拡大表示する `Detail` ビューを搭載。
- **正確なシーク:** マウスホイールを回転させることで、フレーム単位（1/30秒）の微調整が可能です。

### 3. 動的タグ管理システム
- **カスタムカテゴリ:** 「球種」「結果」だけでなく、「カウント」「判定」など任意のカテゴリを自由に追加できます。
- **JSONインポート:** `tags.json` をアップロードすることで、チーム独自のタグ体系を一括で流し込めます。
- **クイックタグ:** 右クリックコンテキストメニューから、選択中のセグメントに対して瞬時にタグを付与できます。

### 4. キーボードショートカット
- `Space`: 再生 / 一時停止
- `B`: 栞（ブックマーク）を挿入
- `Shift + B`: 現在位置の栞を削除
- `Ctrl + Z` / `Cmd + Z`: 栞の削除を取り消し
- `←` / `→` または `[` / `]`: 前後の栞へジャンプ

## 使い方

1. `Select Video File` ボタンから試合映像を選択します。
2. 自動解析が走り、カット位置に自動的に栞が打たれます。
3. タイムラインやショートカットキーで各投球の開始位置を確認・微調整します。
4. 右クリックメニューまたはサイドバーのリストから、各セグメントにタグ（球種、結果等）を付けます。
5. 画面右上の `Export JSON` ボタンで、アノテーションデータを保存します。

## 設定 (Settings)
右上の歯車アイコンをクリックすると設定モーダルが開きます。
- **感度調整:** 23.0（デフォルト）から調整し、動画の切り替わりを再試行できます。
- **タグ管理:** カテゴリの追加・削除、タグの編集が行えます。
- **JSONインポート:** 用意した設定ファイルを読み込めます。

## 開発とデプロイ
このアプリは React (Vite) で構築されています。

### ローカル実行
```bash
cd frontend
npm install
npm run dev
```

### デプロイ (Lolipop FTP)
```bash
bash src/utils/upload_video_analyzer.sh
```

---
[View Live Demo](https://tajmahal.mond.jp/research/video_analyzer/)
